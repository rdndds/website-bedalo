---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const wisata = await getCollection('wisata');
const umkm = await getCollection('umkm');
const berita = await getCollection('berita');

const sections = [
  {
    title: 'Halaman Utama',
    icon: 'üè†',
    color: 'bg-blue-500',
    links: [
      { name: 'Beranda', href: '/', desc: 'Halaman utama website' },
      {
        name: 'Profil Dusun',
        href: '/profil',
        desc: 'Informasi tentang Dusun Bedalo',
      },
      { name: 'Kontak', href: '/kontak', desc: 'Hubungi kami' },
      {
        name: 'Tentang Proyek',
        href: '/tentang-proyek',
        desc: 'Tim pengembang website',
      },
    ],
  },
  {
    title: 'Layanan & Informasi',
    icon: 'üìã',
    color: 'bg-emerald-500',
    links: [
      {
        name: 'Layanan Dusun',
        href: '/layanan',
        desc: 'Layanan administrasi warga',
      },
      {
        name: 'Agenda Kegiatan',
        href: '/agenda',
        desc: 'Jadwal kegiatan dusun',
      },
      { name: 'Berita', href: '/berita', desc: 'Berita dan informasi terbaru' },
      { name: 'Galeri Foto', href: '/galeri', desc: 'Dokumentasi kegiatan' },
    ],
  },
  {
    title: 'Potensi Daerah',
    icon: 'üåü',
    color: 'bg-amber-500',
    links: [
      {
        name: 'Semua Potensi',
        href: '/potensi',
        desc: 'Wisata dan UMKM Dusun Bedalo',
      },
    ],
  },
  {
    title: 'Destinasi Wisata',
    icon: 'üèñÔ∏è',
    color: 'bg-sky-500',
    links: wisata.map((w) => ({
      name: w.data.title,
      href: `/potensi/wisata/${w.slug}`,
      desc: w.data.kategori,
    })),
  },
  {
    title: 'UMKM Lokal',
    icon: 'üõçÔ∏è',
    color: 'bg-rose-500',
    links: umkm.map((u) => ({
      name: u.data.nama,
      href: `/potensi/umkm/${u.slug}`,
      desc: u.data.kategori,
    })),
  },
  {
    title: 'Arsip Berita',
    icon: 'üì∞',
    color: 'bg-purple-500',
    links: berita
      .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
      .slice(0, 6)
      .map((b) => ({
        name: b.data.title,
        href: `/berita/${b.slug}`,
        desc: b.data.kategori,
      })),
  },
];

const totalPages = sections.reduce((acc, s) => acc + s.links.length, 0);
---

<BaseLayout>
  <section class="py-12 lg:py-16">
    <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12" data-aos="fade-up">
        <div
          class="inline-flex items-center justify-center w-16 h-16 bg-primary/10 rounded-2xl mb-4"
        >
          <span class="text-3xl">üó∫Ô∏è</span>
        </div>
        <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-4">
          Peta <span class="gradient-text">Situs</span>
        </h1>
        <p class="text-lg text-gray-600 max-w-2xl mx-auto">
          Navigasi lengkap semua halaman di website Dusun Bedalo
        </p>
        <div
          class="mt-4 inline-flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-full text-sm text-gray-600"
        >
          <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
          {totalPages} halaman tersedia
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {
          sections.map((section, index) => (
            <div
              class="bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow"
              data-aos="fade-up"
              data-aos-delay={index * 100}
            >
              <div class={`${section.color} px-5 py-4`}>
                <div class="flex items-center gap-3">
                  <span class="text-2xl">{section.icon}</span>
                  <h2 class="text-lg font-bold text-white">{section.title}</h2>
                </div>
              </div>
              <div class="p-4">
                <ul class="space-y-1">
                  {section.links.map((link) => (
                    <li>
                      <a
                        href={link.href}
                        class="group flex items-start gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors"
                      >
                        <span class="text-gray-300 group-hover:text-primary transition-colors mt-0.5">
                          <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M9 5l7 7-7 7"
                            />
                          </svg>
                        </span>
                        <div class="flex-1 min-w-0">
                          <div class="font-medium text-gray-900 group-hover:text-primary transition-colors truncate">
                            {link.name}
                          </div>
                          <div class="text-xs text-gray-400 capitalize truncate">
                            {link.desc}
                          </div>
                        </div>
                      </a>
                    </li>
                  ))}
                </ul>
              </div>
            </div>
          ))
        }
      </div>

      <div class="mt-12 text-center">
        <div
          class="inline-flex items-center gap-4 px-6 py-4 bg-gray-50 rounded-2xl"
        >
          <div class="text-left">
            <p class="text-sm text-gray-500">Butuh bantuan navigasi?</p>
            <p class="text-sm font-medium text-gray-700">
              Hubungi kami melalui halaman <a
                href="/kontak"
                class="text-primary hover:underline"
              >
                Kontak
              </a>
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
